---
title: "Motor Vehicle Accidents in Victoria"
author:
- familyname: "Al-Hindi"
  othernames: "Ibrahim"
  address: Monash University
  email: "imalh2@student.monash.edu"
  correspondingauthor: true
  qualifications:  "Master of Business Analytics"
- familyname: "Chouzadjian"
  othernames: "Arek"
  address: Monash University
  email: "acho0007@student.monash.edu"
  correspondingauthor: true
  qualifications: "Master of Business Analytics"
- familyname: "Chen"
  othernames: "Kaihao"
  address: Monash University
  email: "kche154@student.monash.edu"
  correspondingauthor: true
  qualifications: "Master of Business Analytics"
department: "Department of Econometrics and Business Statistics"
organization: VicRoads
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      eval = TRUE,
                      message = FALSE, 
                      warning = FALSE,
                      fig.width=6,
                      fig.height=4)
```

```{r libraries}
library(tidyverse)
library(lubridate)
library(janitor)
library(knitr)
library(kableExtra)
library(bookdown)
```

```{r load-data}
accidents <- read_csv("data/ACCIDENT.csv") %>%
  clean_names()

locations <- read_csv("data/ACCIDENT_LOCATION.csv") %>%
  clean_names()

nodes <- read_csv("data/NODE.csv") %>%
  clean_names()

persons <- read_csv("data/PERSON.csv") %>%
  clean_names()

vehicles <- read_csv("data/VEHICLE.csv") %>%
  clean_names()
```

```{r create-year-hour-day}
accidents <- accidents %>%
  mutate(accidentdate = dmy(accidentdate),
         Year = year(accidentdate),
         Hour = hour(accidenttime),
         Weekday = wday(accidentdate, 
                        label = TRUE,
                        abbr = FALSE))
```


\section*{Temporal factors analysis}

\subsection*{Accidents per year}

```{r chen1, fig.cap= "Car Accidents per year"}
accidents_per_year <- accidents %>%
  count(Year) %>% 
  ggplot(aes(x = Year, 
             y = n)) +
  geom_line() +
  xlab("Year(2006 ~ 2020)") +
  ylab("Number of Car Accidents") +
  geom_point() +
  geom_text(aes(label = n), 
            vjust = -1, 
            color = "black",
            size = 2) 

accidents_per_year
```


According to plot \@ref(fig:chen1), the increasing number of car accidents remained relatively stable from 2006 to 2014, around 14000. After 2014, the increasing speed became faster and then reached the first peak in 2015, second peak in 2016: 15852.After 2016, it started to drop. There is one outstanding change between 2019 and 2020, which it plummeted down from 14164 to 6060. The possible reason is the coming of covid 19 pandemic and the lockdown of Victoria, which made less car on roads, less accidents happened.


\subsection*{Accidents by weekday}

```{r }
accidents_by_weekday <- accidents %>%
  count(Weekday,
        name = "Accidents")

accidents_by_weekday %>%
  kable(caption = "Number of Car Accidents happended by weekday") %>%
  kable_styling(bootstrap_options = "basic")


```



```{r chen2, fig.cap= "Car Accidents by weekday"}
accidents %>%
  count(Weekday,
        name = "Accidents") %>% 
  ggplot(aes(x = Weekday, 
             y = Accidents)) +
  geom_bar(stat = "identity", 
           fill = "#999999") +
  ylab("Number of Car Accidents") +
  geom_text(aes(label = Accidents), 
            vjust = -1, 
            color = "black", 
            size = 3)
```

Regarding to plot \@ref(fig:chen2),it indicates that there is a stable increasing number of car accidents from Sunday to Friday then reach the highest number on Friday. We could understand it from the following reasons: people are getting more and more exhausted during the whole working week, and many people will choose to hang out on Friday night which increase the percentage of driving drunk or reckless. 


\subsection*{Accidents by hour and Death Rate by hour}

```{r chen3, fig.cap= "Car Accidents by hour"}
accidents_by_hour <- accidents %>%
  count(Hour,
        name = "Accidents") 

accidents_by_hour %>%
  ggplot(aes(x = Hour, 
             y = Accidents)) + 
  geom_line() +
  xlab("Time") +
  ylab("Number of Car Accidents") +
  geom_point() +
  geom_text(aes(label = Accidents), 
            vjust = -1, 
            color = "black",
            size = 2) 

```



```{r deaths-by-hour}
deaths_by_hour <- accidents %>%
  group_by(Hour) %>%
  tally(no_persons_killed,
        name = "Deaths")
```

```{r deaths-per-accident-by-hour}
deaths_per_accident_by_hour <- accidents_by_hour %>%
  left_join(deaths_by_hour) %>%
  mutate(Deaths_per_accident = round(Deaths/Accidents, digit = 4))
```

```{r chen4, fig.cap= "Death Rate by hour"}
deaths_per_accident_by_hour %>%
  ggplot(aes(x = Hour, 
             y = Deaths_per_accident)) +
  geom_line() +
  xlab("Time") +
  ylab("Death Rate of Car Accidents") +
  geom_point() +
  geom_text(aes(label = Deaths_per_accident), 
            vjust = -1, 
            color = "black",
            size = 2) 
```


When comparing plot \@ref(fig:chen3) and plot \@ref(fig:chen4), we could notice that these two trend are indicating opposite story, which is the higher number of accidents actually with lower death rate during the same specific time. For examle, 8 o'Ã§lock in the morning reached the first peak of car accidents. However, the death rate of it was the lowest. And the point of 5 o'clock tells a similar story. The \@ref(fig:chen4) actually shows although 2 o'clock in the midnight has almost the lowest volume of car accidents, it has the highest death rate. 

The possible reasons for above results are: both 8 o'clock in the morning and 5 o'clock in the afternoon are the commuter time, which make the traffic busier and more cars on roads, so more accidents. However, most of the accidents won't be too server due to the packed traffic. The 2 o'clock in the midnight is different. First, drivers would be more sleepy and more drivers would take the risk of drunk driving after attending parties in the night which make the accidents have a higher death rate.






